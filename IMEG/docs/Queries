
--#####################################################################################
-- RELATÓRIOS 
--#####################################################################################

/***SELECT PARA AS VIEWS CRIADAS***/
SELECT * FROM BAIXO_ESTOQUE

SELECT * FROM MAIS_VENDIDOS
WHERE UNIDADE = -- INFORMAR O ID DA UNIDADE 

 
/*LISTA OS REGISTROS DE ENTRADA DE PRODUTOS NO ESTOQUE*/
   SELECT ENT.DATA_TRANSACAO    "DATA",
           ENT.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           ENT.QTDE_PRODUTOS,
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_ENTRADA ENT 
    INNER JOIN PRODUTOS PROD ON ENT.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON ENT.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID

/*/*LISTA OS REGISTROS DE ENTRADA DE PRODUTOS NO ESTOQUE AGRUPADOS E SEM EXIBIÇÃO DA DATA*/
    SELECT ENT.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SUM(ENT.QTDE_PRODUTOS),
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_ENTRADA ENT 
    INNER JOIN PRODUTOS PROD ON ENT.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON ENT.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY ENT.PRODUTOS_ID ,PROD.NOME, CATEG.NOME,  PROD.SALDO ,FUNC.NOME,UN.NOME 


/*LISTA OS REGISTROS DE SAIDA DE PRODUTOS NO ESTOQUE*/
    SELECT SAIDA.DATA_TRANSACAO    "DATA",
           SAIDA.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SAIDA.QTDE_PRODUTOS,
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID


/*/*LISTA OS REGISTROS DE ENTRADA DE PRODUTOS NO ESTOQUE AGRUPADOS E SEM EXIBIÇÃO DA DATA*/
    SELECT SAIDA.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SUM(SAIDA.QTDE_PRODUTOS),
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY SAIDA.PRODUTOS_ID ,PROD.NOME, CATEG.NOME,  PROD.SALDO ,FUNC.NOME,UN.NOME 


/*VL. DE VENDA POR FUNCIONARIOS*/ 

 SELECT    FUNC.ID,
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE",
           SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA)
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY FUNC.ID,FUNC.NOME, UN.NOME 
    ORDER BY SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA) DESC


/*VL. DE VENDA POR FUNCIONARIOS E PERÍODO*/ 

 SELECT    FUNC.ID,
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE",
           SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA)
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    WHERE SAIDA.DATA_TRANSACAO BETWEEN '2016-05-09' AND '2016-05-15' /*ALTERAR DATA*/
    GROUP BY FUNC.ID,FUNC.NOME, UN.NOME 
    ORDER BY SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA) DESC


/*VENDA POR UNIDADES*/ 

 SELECT      UN.NOME    "UNIDADE",
             SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA)
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY UN.NOME 
    ORDER BY SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA) DESC


/*VENDA POR UNIDADES E PERÍODO*/

 SELECT      UN.NOME    "UNIDADE",
             SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA)
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    WHERE SAIDA.DATA_TRANSACAO BETWEEN '2016-05-09' AND '2016-05-15' /*ALTERAR DATA*/
    GROUP BY UN.NOME 
    ORDER BY SUM(QTDE_PRODUTOS*SAIDA.PRECO_VENDA) DESC




