
--#####################################################################################
-- RELATÃ“RIOS 
--#####################################################################################


 
/*ENTRADA DE PRODUTOS*/
   SELECT ENT.DATA_TRANSACAO    "DATA",
           ENT.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           ENT.QTDE_PRODUTOS,
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_ENTRADA ENT 
    INNER JOIN PRODUTOS PROD ON ENT.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON ENT.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID

/*ENTRADA DE PRODUTOS SEM DATA*/
    SELECT ENT.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SUM(ENT.QTDE_PRODUTOS),
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_ENTRADA ENT 
    INNER JOIN PRODUTOS PROD ON ENT.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON ENT.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY ENT.PRODUTOS_ID ,PROD.NOME, CATEG.NOME,  PROD.SALDO ,FUNC.NOME,UN.NOME 


/*SAIDA DE PRODUTOS*/
    SELECT SAIDA.DATA_TRANSACAO    "DATA",
           SAIDA.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SAIDA.QTDE_PRODUTOS,
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID


/*SAIDA DE PRODUTOS SEM DATA*/
    SELECT SAIDA.PRODUTOS_ID       "ID" ,
           PROD.NOME             "PRODUTO",
           CATEG.NOME            "CATEGORIA",    
           SUM(SAIDA.QTDE_PRODUTOS),
           PROD.SALDO            "ESTOQUE",   
           FUNC.NOME             "FUNCIONARIO",
           UN.NOME               "UNIDADE"
        FROM ITENS_SAIDA SAIDA 
    INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
    INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
    INNER JOIN FUNCIONARIOS  FUNC ON SAIDA.FUNCIONARIOS_ID = FUNC.ID
    INNER JOIN UNIDADES     UN     ON FUNC.UNIDADES_ID = UN.ID
    GROUP BY SAIDA.PRODUTOS_ID ,PROD.NOME, CATEG.NOME,  PROD.SALDO ,FUNC.NOME,UN.NOME 

/***PRODUTOS MAIS VENDIDOS ***/
CREATE VIEW MAIS_VENDIDOS
AS 
select COUNT(SAIDA.PRODUTOS_ID) "QTD VENDA",
            PROD.NOME  "PRODUTO",
            CATEG.NOME "CATEGORIA"
FROM ITENS_SAIDA SAIDA
INNER JOIN PRODUTOS PROD ON SAIDA.PRODUTOS_ID = PROD.ID
INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
GROUP BY SAIDA.PRODUTOS_ID,PROD.NOME,CATEG.NOME 
ORDER BY COUNT(SAIDA.PRODUTOS_ID) DESC


/***PRODUTOS COM BAIXO ESTOQUE ***/
CREATE VIEW BAIXO_ESTOQUE 
AS 
select PROD.ID,
       PROD.NOME   "PRODUTO",
       CATEG.NOME  "CATEGORIA",
       PROD.PRECO_CUSTO,
       PROD.PRECO_VENDA,
       PROD.QTDE_MIN,
       PROD.QTDE_MAX,
       PROD.SALDO
from PRODUTOS PROD 
INNER JOIN CATEGORIAS CATEG ON PROD.CATEGORIAS_ID = CATEG.ID
WHERE QTDE_MIN >= SALDO

/***SELECT VIEW***/
SELECT * FROM BAIXO_ESTOQUE
SELECT * FROM MAIS_VENDIDOS   

